<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Racing Simulator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0a0a16, #1a1a2e);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #00f3ff;
            margin-bottom: 30px;
            font-size: 36px;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .header {
            background: rgba(30, 30, 50, 0.6);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
        }

        .stat {
            font-size: 18px;
        }

        .stat span {
            color: #00ff88;
            font-weight: bold;
        }

        .btn {
            background: linear-gradient(135deg, rgba(0, 243, 255, 0.3), rgba(185, 103, 255, 0.3));
            border: 1px solid #00f3ff;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 243, 255, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .cars-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .car-card {
            background: rgba(40, 40, 60, 0.6);
            border: 2px solid transparent;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .car-card:hover {
            border-color: #00f3ff;
            transform: translateY(-3px);
        }

        .car-card.selected {
            border-color: #ff2a6d;
            box-shadow: 0 0 15px rgba(255, 42, 109, 0.5);
        }

        .car-card.locked {
            opacity: 0.5;
        }

        .car-stats {
            display: flex;
            justify-content: space-around;
            margin: 10px 0;
            font-size: 12px;
        }

        .mode-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .mode-btn {
            background: rgba(30, 30, 50, 0.6);
            border: 2px solid rgba(255, 255, 255, 0.1);
            color: white;
            padding: 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .mode-btn:hover {
            border-color: #00f3ff;
        }

        .mode-btn.selected {
            border-color: #00ff88;
            background: rgba(0, 255, 136, 0.1);
        }

        .circuit-container {
            width: 100%;
            height: 400px;
            background: #111;
            border-radius: 15px;
            margin: 20px 0;
            position: relative;
            border: 2px solid #00f3ff;
        }

        .track {
            stroke: #333;
            stroke-width: 80;
            fill: none;
        }

        .track-center {
            stroke: #555;
            stroke-width: 2;
            fill: none;
            stroke-dasharray: 10, 10;
        }

        .car-icon {
            position: absolute;
            width: 20px;
            height: 10px;
            background: #ff2a6d;
            border-radius: 3px;
            box-shadow: 0 0 10px rgba(255, 42, 109, 0.7);
        }

        .race-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-box {
            background: rgba(30, 30, 50, 0.6);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-label {
            font-size: 12px;
            color: #aaa;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 24px;
            color: #00f3ff;
            font-weight: bold;
        }

        .manual-control {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(10, 10, 22, 0.9);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #00f3ff;
        }

        .speed-bars {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }

        .speed-bar {
            width: 15px;
            height: 25px;
            background: #333;
            border-radius: 3px;
        }

        .speed-bar.active {
            background: #00ff88;
        }

        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Start Screen -->
        <div class="screen active" id="startScreen">
            <h1>üèéÔ∏è RACING SIMULATOR üèéÔ∏è</h1>
            <div style="text-align: center; margin-top: 50px;">
                <button class="btn" onclick="startGame()" style="font-size: 24px; padding: 20px 40px;">START GAME</button>
            </div>
        </div>

        <!-- Garage Screen -->
        <div class="screen" id="garageScreen">
            <h1>GARAGE</h1>
            <div class="header">
                <div class="stat">Credits: <span id="money">$1,000</span></div>
                <div class="stat">Level: <span id="level">1</span></div>
            </div>

            <h2 style="color: #00f3ff; margin: 20px 0;">SELECT YOUR CAR</h2>
            <div class="cars-grid" id="carsGrid"></div>

            <div style="text-align: center; margin-top: 30px;">
                <button class="btn" onclick="showRaceSetup()">CONTINUE TO RACE SETUP</button>
            </div>
        </div>

        <!-- Race Setup Screen -->
        <div class="screen" id="raceSetupScreen">
            <h1>RACE SETUP</h1>
            <div class="header">
                <div class="stat">Selected Car: <span id="selectedCar">Honda Civic</span></div>
            </div>

            <h3 style="color: #00ff88; margin: 20px 0;">SELECT CIRCUIT</h3>
            <div class="mode-buttons">
                <button class="mode-btn selected" onclick="selectCircuit('small')">
                    <div style="font-size: 18px; margin-bottom: 5px;">SMALL CIRCUIT</div>
                    <div style="font-size: 12px; color: #aaa;">Quick race</div>
                </button>
                <button class="mode-btn" onclick="selectCircuit('large')">
                    <div style="font-size: 18px; margin-bottom: 5px;">LARGE CIRCUIT</div>
                    <div style="font-size: 12px; color: #aaa;">More challenging</div>
                </button>
                <button class="mode-btn" onclick="selectCircuit('oval')">
                    <div style="font-size: 18px; margin-bottom: 5px;">OVAL CIRCUIT</div>
                    <div style="font-size: 12px; color: #aaa;">High speed</div>
                </button>
            </div>

            <h3 style="color: #00ff88; margin: 20px 0;">SELECT LAPS</h3>
            <div class="mode-buttons">
                <button class="mode-btn selected" onclick="selectLaps(1)">1 LAP</button>
                <button class="mode-btn" onclick="selectLaps(3)">3 LAPS</button>
                <button class="mode-btn" onclick="selectLaps(5)">5 LAPS</button>
            </div>

            <div class="controls">
                <button class="btn" onclick="showGarage()">BACK TO GARAGE</button>
                <button class="btn" onclick="startRace()" style="background: linear-gradient(135deg, rgba(0, 255, 136, 0.3), rgba(0, 243, 255, 0.3));">START RACE</button>
                <button class="btn" onclick="startManualRace()" id="manualBtn" disabled>MANUAL CONTROL</button>
            </div>
        </div>

        <!-- Race Screen -->
        <div class="screen" id="raceScreen">
            <h1>RACING</h1>
            <div class="race-stats">
                <div class="stat-box">
                    <div class="stat-label">SPEED</div>
                    <div class="stat-value" id="raceSpeed">0 MPH</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">LAP TIME</div>
                    <div class="stat-value" id="lapTime">0.0s</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">PROGRESS</div>
                    <div class="stat-value" id="progress">0%</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">LAP</div>
                    <div class="stat-value" id="currentLap">1/1</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">EARNINGS</div>
                    <div class="stat-value" id="earnings">$0</div>
                </div>
            </div>

            <div class="circuit-container">
                <svg class="circuit" viewBox="0 0 800 400">
                    <path class="track" id="track" d="M 100 200 Q 100 50, 400 50 T 700 200 Q 700 350, 400 350 T 100 200"/>
                    <path class="track-center" id="trackCenter" d="M 100 200 Q 100 50, 400 50 T 700 200 Q 700 350, 400 350 T 100 200"/>
                </svg>
                <div class="car-icon" id="carIcon"></div>
                
                <div class="manual-control" id="manualControl" style="display: none;">
                    <div style="font-weight: bold; margin-bottom: 10px;">MANUAL SPEED: <span id="speedDisplay">3</span></div>
                    <div class="speed-bars">
                        <div class="speed-bar" id="bar1"></div>
                        <div class="speed-bar" id="bar2"></div>
                        <div class="speed-bar" id="bar3"></div>
                        <div class="speed-bar" id="bar4"></div>
                        <div class="speed-bar" id="bar5"></div>
                    </div>
                    <div style="font-size: 11px; margin-top: 10px; color: #aaa;">‚Üë SPEED UP | ‚Üì SLOW DOWN</div>
                </div>
            </div>

            <div class="controls">
                <button class="btn" onclick="endRace()">END RACE</button>
            </div>
        </div>
    </div>

    <script>
        // Game State
        const gameState = {
            money: 1000,
            level: 1,
            currentCar: 0,
            ownedCars: [0],
            circuit: 'small',
            laps: 1,
            manualSpeed: 3
        };

        // Cars
        const cars = [
            { id: 0, name: "Honda Civic", speed: 50, price: 0, level: 0 },
            { id: 1, name: "Toyota Corolla", speed: 55, price: 5000, level: 1 },
            { id: 2, name: "Mazda MX-5", speed: 60, price: 8000, level: 2 },
            { id: 3, name: "VW Golf GTI", speed: 70, price: 12000, level: 3 },
            { id: 4, name: "Ford Mustang", speed: 80, price: 18000, level: 4 },
            { id: 5, name: "Subaru WRX", speed: 85, price: 25000, level: 5 },
            { id: 6, name: "BMW M3", speed: 90, price: 35000, level: 6 },
            { id: 7, name: "Audi RS5", speed: 92, price: 45000, level: 7 },
            { id: 8, name: "Mercedes C63", speed: 94, price: 55000, level: 8 },
            { id: 9, name: "Nissan GT-R", speed: 95, price: 65000, level: 9 },
            { id: 10, name: "Corvette", speed: 96, price: 75000, level: 10 },
            { id: 11, name: "Porsche 911", speed: 97, price: 85000, level: 11 },
            { id: 12, name: "McLaren 570S", speed: 98, price: 120000, level: 15 },
            { id: 13, name: "Ferrari LaFerrari", speed: 99, price: 2800000, level: 20 },
            { id: 14, name: "Bugatti Chiron", speed: 100, price: 3000000, level: 25 }
        ];

        // Race state
        let raceActive = false;
        let raceData = { progress: 0, speed: 0, time: 0, currentLap: 1, earnings: 0, isManual: false };
        let raceInterval;

        function startGame() {
            showScreen('garageScreen');
            updateGarage();
        }

        function updateGarage() {
            document.getElementById('money').textContent = `$${gameState.money.toLocaleString()}`;
            document.getElementById('level').textContent = gameState.level;

            const grid = document.getElementById('carsGrid');
            grid.innerHTML = cars.map(car => {
                const owned = gameState.ownedCars.includes(car.id);
                const selected = gameState.currentCar === car.id;
                const locked = !owned && (car.level > gameState.level || car.price > gameState.money);

                return `
                    <div class="car-card ${selected ? 'selected' : ''} ${locked ? 'locked' : ''}" 
                         onclick="selectCar(${car.id})">
                        <div style="font-weight: bold; margin-bottom: 10px;">${car.name}</div>
                        <div class="car-stats">
                            <div>Speed<br>${car.speed}</div>
                        </div>
                        <div style="color: #00ff88; font-size: 18px; font-weight: bold;">
                            ${owned ? 'OWNED' : `$${car.price.toLocaleString()}`}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function selectCar(id) {
            const car = cars.find(c => c.id === id);
            if (gameState.ownedCars.includes(id)) {
                gameState.currentCar = id;
                updateGarage();
            } else if (car.level > gameState.level) {
                alert(`Requires Level ${car.level}!`);
            } else if (car.price > gameState.money) {
                alert(`Need $${(car.price - gameState.money).toLocaleString()} more!`);
            } else {
                gameState.money -= car.price;
                gameState.ownedCars.push(id);
                gameState.currentCar = id;
                updateGarage();
            }
        }

        function showGarage() {
            showScreen('garageScreen');
            updateGarage();
        }

        function showRaceSetup() {
            showScreen('raceSetupScreen');
            const car = cars.find(c => c.id === gameState.currentCar);
            document.getElementById('selectedCar').textContent = car.name;
            document.getElementById('manualBtn').disabled = gameState.level < 5;
        }

        function selectCircuit(type) {
            gameState.circuit = type;
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            
            const tracks = {
                small: 'M 100 200 Q 100 50, 400 50 T 700 200 Q 700 350, 400 350 T 100 200',
                large: 'M 50 200 Q 50 30, 200 30 L 600 30 Q 750 30, 750 150 L 750 250 Q 750 370, 600 370 L 200 370 Q 50 370, 50 250 Z',
                oval: 'M 150 200 A 200 80 0 1 1 650 200 A 200 80 0 1 1 150 200'
            };
            
            document.getElementById('track').setAttribute('d', tracks[type]);
            document.getElementById('trackCenter').setAttribute('d', tracks[type]);
        }

        function selectLaps(laps) {
            gameState.laps = laps;
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
        }

        function startRace() {
            showScreen('raceScreen');
            raceActive = true;
            raceData = { progress: 0, speed: 0, time: 0, currentLap: 1, earnings: 0, isManual: false };
            document.getElementById('manualControl').style.display = 'none';
            runRace();
        }

        function startManualRace() {
            if (gameState.level < 5) return;
            showScreen('raceScreen');
            raceActive = true;
            raceData = { progress: 0, speed: 0, time: 0, currentLap: 1, earnings: 0, isManual: true };
            document.getElementById('manualControl').style.display = 'block';
            gameState.manualSpeed = 3;
            updateManualDisplay();
            runRace();
        }

        function runRace() {
            const car = cars.find(c => c.id === gameState.currentCar);
            
            raceInterval = setInterval(() => {
                if (!raceActive) {
                    clearInterval(raceInterval);
                    return;
                }

                raceData.time += 0.1;
                
                if (raceData.isManual) {
                    const speedLevels = [30, 60, 90, 120, 150];
                    raceData.speed = speedLevels[gameState.manualSpeed - 1];
                } else {
                    raceData.speed = car.speed + Math.random() * 10;
                }
                
                raceData.progress += (raceData.speed / 100) * 2;
                raceData.earnings = Math.round((raceData.speed * 10) / (raceData.time + 1) * gameState.laps);

                updateCarPosition();
                
                document.getElementById('raceSpeed').textContent = `${Math.round(raceData.speed * 2)} MPH`;
                document.getElementById('lapTime').textContent = `${raceData.time.toFixed(1)}s`;
                document.getElementById('progress').textContent = `${Math.round(raceData.progress)}%`;
                document.getElementById('currentLap').textContent = `${raceData.currentLap}/${gameState.laps}`;
                document.getElementById('earnings').textContent = `$${raceData.earnings}`;

                if (raceData.progress >= 100) {
                    if (raceData.currentLap < gameState.laps) {
                        raceData.currentLap++;
                        raceData.progress = 0;
                    } else {
                        finishRace();
                    }
                }
            }, 100);
        }

        function updateCarPosition() {
            const track = document.getElementById('trackCenter');
            const car = document.getElementById('carIcon');
            const length = track.getTotalLength();
            const point = track.getPointAtLength((raceData.progress / 100) * length);
            
            car.style.left = `${point.x - 10}px`;
            car.style.top = `${point.y - 5}px`;
            
            const point2 = track.getPointAtLength(((raceData.progress + 1) / 100) * length);
            const angle = Math.atan2(point2.y - point.y, point2.x - point.x) * 180 / Math.PI;
            car.style.transform = `rotate(${angle}deg)`;
        }

        function updateManualDisplay() {
            document.getElementById('speedDisplay').textContent = gameState.manualSpeed;
            for (let i = 1; i <= 5; i++) {
                const bar = document.getElementById(`bar${i}`);
                bar.classList.toggle('active', i <= gameState.manualSpeed);
            }
        }

        document.addEventListener('keydown', (e) => {
            if (!raceActive || !raceData.isManual) return;
            
            if (e.key === 'ArrowUp' && gameState.manualSpeed < 5) {
                gameState.manualSpeed++;
                updateManualDisplay();
            } else if (e.key === 'ArrowDown' && gameState.manualSpeed > 1) {
                gameState.manualSpeed--;
                updateManualDisplay();
            }
        });

        function finishRace() {
            raceActive = false;
            clearInterval(raceInterval);
            
            gameState.money += raceData.earnings;
            gameState.level = Math.floor(gameState.money / 10000) + 1;
            
            alert(`Race Complete!\nEarned: $${raceData.earnings}\nTime: ${raceData.time.toFixed(1)}s`);
            
            showGarage();
        }

        function endRace() {
            raceActive = false;
            clearInterval(raceInterval);
            showGarage();
        }

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }
    </script>
</body>
</html>